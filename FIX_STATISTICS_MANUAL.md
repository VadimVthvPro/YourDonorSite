# üìò –ò–ù–°–¢–†–£–ö–¶–ò–Ø: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–ú–∞–Ω—É–∞–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)

## üéØ –¶–µ–ª—å

–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –¥–æ–Ω–æ—Ä–æ–≤ –∏ –º–µ–¥—Ü–µ–Ω—Ç—Ä–æ–≤ –ø—É—Ç—ë–º –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è —Å—Ö–µ–º—ã –ë–î –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å backend –∫–æ–¥–æ–º.

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. ‚ùå –í –ë–î: `user_id`, –≤ –∫–æ–¥–µ: `donor_id`
2. ‚ùå –í –ë–î: `blood_center_id`, –≤ –∫–æ–¥–µ: `medical_center_id`
3. ‚ùå Frontend –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ë–î (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏, –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ)
- –û–±–Ω–æ–≤–∏—Ç—å frontend (–¥–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ `loadDonationStatistics()`)
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã

---

## üìã –®–ê–ì 1: –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@178.172.212.221
```

**–ü–∞—Ä–æ–ª—å:** *(–≤–∞—à –ø–∞—Ä–æ–ª—å root)*

---

## üìã –®–ê–ì 2: –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª—ã

### 2.1. SQL –º–∏–≥—Ä–∞—Ü–∏—è

**–ù–∞ –í–ê–®–ï–ú Mac:**

```bash
cd /Users/VadimVthv/Your_donor
scp migrate_donation_history_schema.sql root@178.172.212.221:/tmp/
```

### 2.2. –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π app.py

```bash
scp website/backend/app.py root@178.172.212.221:/opt/tvoydonor/website/backend/
```

### 2.3. –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π donor-dashboard.js

```bash
scp website/js/donor-dashboard.js root@178.172.212.221:/opt/tvoydonor/website/js/
```

**–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ.**

---

## üìã –®–ê–ì 3: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (—É–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –ø–æ SSH):**

### 3.1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å—Ö–µ–º—É

```bash
sudo -u postgres psql -d your_donor
```

–í psql –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
\d donation_history
```

**–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:**
- `user_id` (—Å—Ç–∞—Ä–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)
- `blood_center_id` (—Å—Ç–∞—Ä–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)

–ù–∞–∂–º–∏—Ç–µ **q** –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.

**–ù–ï –í–´–•–û–î–ò–¢–ï** –∏–∑ psql, –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É!

---

### 3.2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é

**–í psql –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:**

```sql
\i /tmp/migrate_donation_history_schema.sql
```

**–î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.** –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

```
‚úÖ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞: donation_history_backup_20260126
‚úÖ –ö–æ–ª–æ–Ω–∫–∞ user_id –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∞ –≤ donor_id
‚úÖ –ö–æ–ª–æ–Ω–∫–∞ blood_center_id –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∞ –≤ medical_center_id
‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
```

---

### 3.3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É

**–í psql –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:**

```sql
\d donation_history
```

**–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:**
- ‚úÖ `donor_id` (–≤–º–µ—Å—Ç–æ `user_id`)
- ‚úÖ `medical_center_id` (–≤–º–µ—Å—Ç–æ `blood_center_id`)
- ‚úÖ `blood_type`
- ‚úÖ `status`
- ‚úÖ `response_id`

–ù–∞–∂–º–∏—Ç–µ **q**, –∑–∞—Ç–µ–º –≤—ã–π–¥–∏—Ç–µ –∏–∑ psql:

```sql
\q
```

---

## üìã –®–ê–ì 4: –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (–≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ bash):**

```bash
cd /opt/tvoydonor/website

# –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –¥–ª—è cache-busting
TIMESTAMP=$(date +%s)
sed -i "s/window.VERSION = .*/window.VERSION = '${TIMESTAMP}';/" js/config.js
echo "‚úÖ –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: ${TIMESTAMP}"

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å nginx
nginx -t && systemctl reload nginx

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å API
supervisorctl restart tvoydonor-api

# –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
> /var/log/tvoydonor-api.err.log
> /var/log/tvoydonor-api.out.log

echo "‚úÖ –í—Å—ë –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ!"
```

---

## üìã –®–ê–ì 5: –í—ã–π—Ç–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞

```bash
exit
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç 1: –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ: **https://tvoydonor.by**
2. **–ù–∞–∂–º–∏—Ç–µ:** **Ctrl+Shift+R** (Windows) –∏–ª–∏ **Cmd+Shift+R** (Mac)
3. **–î–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è**

---

### –¢–µ—Å—Ç 2: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ–Ω–æ—Ä–∞

1. **–ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å** –∫–∞–∫ –¥–æ–Ω–æ—Ä
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ** –≤ —Ä–∞–∑–¥–µ–ª "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
3. **–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞** (F12)
4. **–ò—â–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏:**
   ```
   –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞: {total_donations: ..., donations_history: [...], ...}
   ```

**‚úÖ –û–∂–∏–¥–∞–µ—Ç—Å—è:**
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–Ω–∞—Ü–∏–π
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è –¥–æ–Ω–∞—Ü–∏–π (—Ç–∞–±–ª–∏—Ü–∞)
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫ –ø–æ –º–µ—Å—è—Ü–∞–º
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —É—Ä–æ–≤–µ–Ω—å –¥–æ–Ω–æ—Ä–∞
- –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**‚ùå –ï—Å–ª–∏ –ø—É—Å—Ç–æ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: `tail -50 /var/log/tvoydonor-api.err.log`

---

### –¢–µ—Å—Ç 3: –ó–∞–ø–∏—Å—å –¥–æ–Ω–∞—Ü–∏–∏ (–º–µ–¥—Ü–µ–Ω—Ç—Ä)

1. **–ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å** –∫–∞–∫ –º–µ–¥—Ü–µ–Ω—Ç—Ä
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ** –≤ —Ä–∞–∑–¥–µ–ª "–û—Ç–∫–ª–∏–∫–∏"
3. **–ù–∞–∂–º–∏—Ç–µ** "–û–¥–æ–±—Ä–∏—Ç—å" –Ω–∞ –∫–∞–∫–æ–º-–ª–∏–±–æ –æ—Ç–∫–ª–∏–∫–µ
4. **–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å** - –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ 500

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):**

```bash
ssh root@178.172.212.221
sudo -u postgres psql -d your_donor -c "SELECT * FROM donation_history ORDER BY created_at DESC LIMIT 3;"
```

**‚úÖ –û–∂–∏–¥–∞–µ—Ç—Å—è:** –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ `donor_id`, `medical_center_id`, `blood_type`, `status`.

---

### –¢–µ—Å—Ç 4: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–µ–¥—Ü–µ–Ω—Ç—Ä–∞

1. **–ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å** –∫–∞–∫ –º–µ–¥—Ü–µ–Ω—Ç—Ä
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ** –≤ —Ä–∞–∑–¥–µ–ª "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
3. **–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ú–µ—Å—è—Ü")

**‚úÖ –û–∂–∏–¥–∞–µ—Ç—Å—è:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–Ω–∞—Ü–∏–π > 0
- –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ –≥—Ä—É–ø–ø–∞–º –∫—Ä–æ–≤–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- –î–∏–∞–≥—Ä–∞–º–º–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

---

## ‚ö†Ô∏è –û–¢–ö–ê–¢ (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å)

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
ssh root@178.172.212.221
sudo -u postgres psql -d your_donor
```

**–í psql:**

```sql
-- –£–¥–∞–ª–∏—Ç—å –∏–∑–º–µ–Ω—ë–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
DROP TABLE donation_history;

-- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
ALTER TABLE donation_history_backup_20260126 RENAME TO donation_history;

\q
```

**–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å API:**

```bash
supervisorctl restart tvoydonor-api
```

---

## üìä –ü–†–û–í–ï–†–ö–ê –õ–û–ì–û–í

**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**

```bash
ssh root@178.172.212.221

# –û—à–∏–±–∫–∏ API
tail -50 /var/log/tvoydonor-api.err.log

# –í—ã–≤–æ–¥ API
tail -50 /var/log/tvoydonor-api.out.log

# –û—à–∏–±–∫–∏ Nginx
tail -50 /var/log/nginx/error.log
```

---

## ‚úÖ –ò–¢–û–ì–ò

**–ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:**
1. ‚úÖ –°—Ö–µ–º–∞ –ë–î –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å backend (`donor_id`, `medical_center_id`)
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏ (`blood_type`, `status`, `response_id`)
3. ‚úÖ app.py –æ–±–Ω–æ–≤–ª—ë–Ω (INSERT —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç `blood_type`, `status`, `response_id`)
4. ‚úÖ Frontend —Ç–µ–ø–µ—Ä—å –≤—ã–∑—ã–≤–∞–µ—Ç `loadDonationStatistics()` –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
5. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –ë–î (`donation_history_backup_20260126`)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –î–æ–Ω–∞—Ü–∏–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ë–î –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è –¥–æ–Ω–æ—Ä–æ–≤
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è –º–µ–¥—Ü–µ–Ω—Ç—Ä–æ–≤

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –æ–±–µ–∏—Ö —Ä–æ–ª–µ–π!

**–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å–º–æ—Ç—Ä–∏—Ç–µ:** `STATISTICS_RESEARCH.md`
