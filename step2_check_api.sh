#!/bin/bash
echo "========================================="
echo "üîç –®–ê–ì 2: –ü–†–û–í–ï–†–ö–ê BACKEND API"
echo "========================================="

ssh root@178.172.212.221 << 'ENDSSH'

echo ""
echo "1Ô∏è‚É£ –≠–ù–î–ü–û–ò–ù–¢–´ –°–¢–ê–¢–ò–°–¢–ò–ö–ò:"
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
echo ""

grep -n "@app.route.*statistics\|@app.route.*stats" /opt/tvoydonor/website/backend/app.py | head -20

echo ""
echo "2Ô∏è‚É£ –§–£–ù–ö–¶–ò–Ø get_donor_statistics:"
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
echo ""

sed -n '615,720p' /opt/tvoydonor/website/backend/app.py

echo ""
echo "3Ô∏è‚É£ –§–£–ù–ö–¶–ò–Ø get_medcenter_stats:"
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
echo ""

sed -n '2497,2540p' /opt/tvoydonor/website/backend/app.py

echo ""
echo "4Ô∏è‚É£ –§–£–ù–ö–¶–ò–Ø update_response (–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –¥–æ–Ω–∞—Ü–∏–π):"
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
echo ""

sed -n '2130,2150p' /opt/tvoydonor/website/backend/app.py

echo ""
echo "5Ô∏è‚É£ –õ–û–ì–ò API (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫):"
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
echo ""

tail -50 /var/log/tvoydonor-api.err.log

echo ""
echo "6Ô∏è‚É£ –¢–ï–°–¢ API –Ω–∞–ø—Ä—è–º—É—é (curl):"
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
echo ""
echo "–ü–æ–ø—ã—Ç–∫–∞ GET /api/donor/statistics (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞ - –æ–∂–∏–¥–∞–µ–º 401):"
curl -s http://localhost:5001/api/donor/statistics | head -20

echo ""
echo "–ü–æ–ø—ã—Ç–∫–∞ GET /api/stats/medcenter (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞ - –æ–∂–∏–¥–∞–µ–º 401):"
curl -s http://localhost:5001/api/stats/medcenter | head -20

echo ""
echo "=========================================
‚úÖ –ü–†–û–í–ï–†–ö–ê API –ó–ê–í–ï–†–®–ï–ù–ê
=========================================
"

ENDSSH
